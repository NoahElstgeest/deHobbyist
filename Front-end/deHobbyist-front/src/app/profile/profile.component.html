<div class="container my-5" *ngIf="!loading; else loadingTpl">
  <div *ngIf="!error; else errorTpl">
    <h2 class="mb-4 text-center text-brown">Welkom, {{ me?.username }}</h2>

    <div class="card shadow-sm mb-4 border-0 mx-auto profile-card" *ngIf="me as user">
      <div class="card-body">
        <h5 class="mb-3 text-brown">Profielinformatie</h5>
        <p class="mb-1"><strong>E-mailadres:</strong> {{ user.email }}</p>

        <hr>

        <h5 class="mt-4 text-brown">Adresgegevens</h5>

        <form #addressForm="ngForm" (ngSubmit)="saveAddresses()" novalidate>
          <div class="mb-3">
            <label for="shippingAddress" class="form-label fw-semibold">Verzendadres</label>
            <textarea
              id="shippingAddress"
              name="shippingAddress"
              class="form-control"
              rows="3"
              required
              placeholder="Straatnaam 1, 1234 AB, Plaats"
              [(ngModel)]="user.shippingAddress"></textarea>
          </div>

          <div class="mb-3">
            <label for="billingAddress" class="form-label fw-semibold">Factuuradres</label>
            <textarea
              id="billingAddress"
              name="billingAddress"
              class="form-control"
              rows="3"
              required
              placeholder="Straatnaam 1, 1234 AB, Plaats"
              [(ngModel)]="user.billingAddress"></textarea>
          </div>

          <div class="text-center mt-4">
            <button type="submit" class="btn btn-dark px-4"
                    [disabled]="saving || !addressForm.valid">
              <span *ngIf="!saving">Opslaan</span>
              <span *ngIf="saving" class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>
              <span *ngIf="saving">Bezig met opslaanâ€¦</span>
            </button>
          </div>

          <div *ngIf="saveMessage" class="alert alert-success mt-3 text-center">{{ saveMessage }}</div>
          <div *ngIf="saveError" class="alert alert-danger mt-3 text-center">{{ saveError }}</div>
        </form>
      </div>
    </div>

    <div class="text-center">
      <a routerLink="/profile/orders" class="btn btn-outline-dark me-2">Bekijk mijn bestellingen</a>
    </div>
  </div>
</div>

<ng-template #loadingTpl>
  <div class="text-center my-5">
    <div class="spinner-border" role="status" aria-label="Laden"></div>
  </div>
</ng-template>

<ng-template #errorTpl>
  <div class="alert alert-danger">{{ error }}</div>
</ng-template>
